---

title: 10 Why Hat

keywords: fastai
sidebar: home_sidebar

summary: "Analytical approach using Neural Network on tabulate data"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/20_why_hat.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The core engine for project $\large\hat{y}$.</p>
<p>The dataset is from <a href="https://www.kaggle.com/dgomonov/new-york-city-airbnb-open-data#AB_NYC_2019.csv">New York City Airbnb Open Data</a> on kaggle</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DATA</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;../data&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">CSV_PATH</span> <span class="o">=</span> <span class="n">DATA</span><span class="o">/</span><span class="s2">&quot;AB_NYC_2019.csv&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The AirBnB New York 2019 dataset</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">CSV_PATH</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>host_id</th>
      <th>host_name</th>
      <th>neighbourhood_group</th>
      <th>neighbourhood</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>room_type</th>
      <th>price</th>
      <th>minimum_nights</th>
      <th>number_of_reviews</th>
      <th>last_review</th>
      <th>reviews_per_month</th>
      <th>calculated_host_listings_count</th>
      <th>availability_365</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>17324</th>
      <td>13676601</td>
      <td>Here's a great offer on a spacious furnished r...</td>
      <td>79598330</td>
      <td>Nesha</td>
      <td>Brooklyn</td>
      <td>East Flatbush</td>
      <td>40.66337</td>
      <td>-73.92576</td>
      <td>Private room</td>
      <td>30</td>
      <td>3</td>
      <td>20</td>
      <td>2018-03-31</td>
      <td>0.54</td>
      <td>1</td>
      <td>27</td>
    </tr>
    <tr>
      <th>20494</th>
      <td>16323239</td>
      <td>Spacious 2 BDR - Hell's Kitchen/Times Square</td>
      <td>2559886</td>
      <td>Sy</td>
      <td>Manhattan</td>
      <td>Hell's Kitchen</td>
      <td>40.76284</td>
      <td>-73.98849</td>
      <td>Entire home/apt</td>
      <td>130</td>
      <td>4</td>
      <td>2</td>
      <td>2017-11-30</td>
      <td>0.07</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>27546</th>
      <td>21679639</td>
      <td>Entire 1-Bedroom Greenpoint Apartment</td>
      <td>4696622</td>
      <td>James</td>
      <td>Brooklyn</td>
      <td>Greenpoint</td>
      <td>40.72747</td>
      <td>-73.95462</td>
      <td>Entire home/apt</td>
      <td>95</td>
      <td>3</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>45469</th>
      <td>34776151</td>
      <td>Bedroom + den + bath w/ sep. entry in Bed Stuy!</td>
      <td>73612539</td>
      <td>Rebecca</td>
      <td>Brooklyn</td>
      <td>Bedford-Stuyvesant</td>
      <td>40.68602</td>
      <td>-73.94844</td>
      <td>Private room</td>
      <td>68</td>
      <td>1</td>
      <td>8</td>
      <td>2019-07-02</td>
      <td>6.32</td>
      <td>2</td>
      <td>36</td>
    </tr>
    <tr>
      <th>33070</th>
      <td>26085075</td>
      <td>Charming studio with PRIVATE DECK by McCarren ...</td>
      <td>27530449</td>
      <td>Estefania</td>
      <td>Brooklyn</td>
      <td>Greenpoint</td>
      <td>40.72173</td>
      <td>-73.94820</td>
      <td>Private room</td>
      <td>106</td>
      <td>4</td>
      <td>21</td>
      <td>2019-06-03</td>
      <td>1.73</td>
      <td>2</td>
      <td>58</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>15634892</td>
      <td>Adorable, NYC studio for the holiday!</td>
      <td>15353668</td>
      <td>Bria</td>
      <td>Manhattan</td>
      <td>Midtown</td>
      <td>40.75228</td>
      <td>-73.97186</td>
      <td>Entire home/apt</td>
      <td>144</td>
      <td>28</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>90</td>
    </tr>
    <tr>
      <th>39825</th>
      <td>30954420</td>
      <td>Artistic apartment in the Heart of Manhattan</td>
      <td>231298987</td>
      <td>Austin</td>
      <td>Manhattan</td>
      <td>Lower East Side</td>
      <td>40.71890</td>
      <td>-73.98599</td>
      <td>Entire home/apt</td>
      <td>200</td>
      <td>4</td>
      <td>1</td>
      <td>2019-03-16</td>
      <td>0.26</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10897</th>
      <td>8407092</td>
      <td>Historic Ridgewood Brick Townhouse</td>
      <td>9684993</td>
      <td>Randy</td>
      <td>Queens</td>
      <td>Ridgewood</td>
      <td>40.70928</td>
      <td>-73.89795</td>
      <td>Entire home/apt</td>
      <td>139</td>
      <td>5</td>
      <td>3</td>
      <td>2018-07-30</td>
      <td>0.16</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10715</th>
      <td>8247721</td>
      <td>Charming Crown Heights Brownstone</td>
      <td>43494916</td>
      <td>Tilly</td>
      <td>Brooklyn</td>
      <td>Crown Heights</td>
      <td>40.67791</td>
      <td>-73.95337</td>
      <td>Entire home/apt</td>
      <td>80</td>
      <td>3</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5187</th>
      <td>3743048</td>
      <td>*WARM*Beautiful*Room*ST. GEORGE steps to ferry!</td>
      <td>19143974</td>
      <td>Meghan</td>
      <td>Staten Island</td>
      <td>St. George</td>
      <td>40.64408</td>
      <td>-74.07834</td>
      <td>Private room</td>
      <td>58</td>
      <td>3</td>
      <td>93</td>
      <td>2019-05-06</td>
      <td>2.10</td>
      <td>1</td>
      <td>279</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Config-how-we-learn-the-columns">Config how we learn the columns<a class="anchor-link" href="#Config-how-we-learn-the-columns">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is a python/console interface, that will</p>
<ul>
<li>guide the user through columns one by one, </li>
<li>let user decide how should we treat a column during the learning</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="md5hash" class="doc_header"><code>md5hash</code><a href="https://github.com/raynardj/torchember/tree/master/torchember/whyhat.py#L22" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>md5hash</code>(<strong><code>x</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="X-input-modules">X input modules<a class="anchor-link" href="#X-input-modules">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ModelInput" class="doc_header"><code>class</code> <code>ModelInput</code><a href="https://github.com/raynardj/torchember/tree/master/torchember/whyhat.py#L26" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ModelInput</code>(<strong><code>rich_col</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super(Model, self).__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="InputEmb" class="doc_header"><code>class</code> <code>InputEmb</code><a href="https://github.com/raynardj/torchember/tree/master/torchember/whyhat.py#L32" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>InputEmb</code>(<strong><code>rich_col</code></strong>) :: <a href="/torchember/why_hat#ModelInput"><code>ModelInput</code></a></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super(Model, self).__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="InputOneHot" class="doc_header"><code>class</code> <code>InputOneHot</code><a href="https://github.com/raynardj/torchember/tree/master/torchember/whyhat.py#L40" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>InputOneHot</code>(<strong><code>rich_col</code></strong>) :: <a href="/torchember/why_hat#ModelInput"><code>ModelInput</code></a></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super(Model, self).__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="InputConti" class="doc_header"><code>class</code> <code>InputConti</code><a href="https://github.com/raynardj/torchember/tree/master/torchember/whyhat.py#L48" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>InputConti</code>(<strong><code>rich_col</code></strong>) :: <a href="/torchember/why_hat#ModelInput"><code>ModelInput</code></a></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super(Model, self).__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Y-target-encode">Y target encode<a class="anchor-link" href="#Y-target-encode">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="YEncoder" class="doc_header"><code>class</code> <code>YEncoder</code><a href="https://github.com/raynardj/torchember/tree/master/torchember/whyhat.py#L62" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>YEncoder</code>(<strong><code>rich_col</code></strong>)</p>
</blockquote>
<p>Encode the why into the required shape
input of the <strong>call</strong>, numpy array</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="YOneHot" class="doc_header"><code>class</code> <code>YOneHot</code><a href="https://github.com/raynardj/torchember/tree/master/torchember/whyhat.py#L76" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>YOneHot</code>(<strong><code>rich_col</code></strong>) :: <a href="/torchember/why_hat#YEncoder"><code>YEncoder</code></a></p>
</blockquote>
<p>Encode the why into the required shape
input of the <strong>call</strong>, numpy array</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="YConti" class="doc_header"><code>class</code> <code>YConti</code><a href="https://github.com/raynardj/torchember/tree/master/torchember/whyhat.py#L84" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>YConti</code>(<strong><code>rich_col</code></strong>) :: <a href="/torchember/why_hat#YEncoder"><code>YEncoder</code></a></p>
</blockquote>
<p>Encode the why into the required shape
input of the <strong>call</strong>, numpy array</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Enhanced-columns">Enhanced columns<a class="anchor-link" href="#Enhanced-columns">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RichColumn" class="doc_header"><code>class</code> <code>RichColumn</code><a href="https://github.com/raynardj/torchember/tree/master/torchember/whyhat.py#L94" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RichColumn</code>(<strong><code>column</code></strong>, <strong><code>is_y</code></strong>=<em><code>False</code></em>, <strong><code>min_occur</code></strong>=<em><code>5</code></em>, <strong><code>is_emb</code></strong>=<em><code>True</code></em>, <strong><code>hidden_size</code></strong>=<em><code>20</code></em>)</p>
</blockquote>
<p>A pandas series manager</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RichDF" class="doc_header"><code>class</code> <code>RichDF</code><a href="https://github.com/raynardj/torchember/tree/master/torchember/whyhat.py#L212" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RichDF</code>(<strong><code>df</code></strong>, <strong><code>fname</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>A pandas dataframe manager</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rdf</span> <span class="o">=</span> <span class="n">RichDF</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">fname</span> <span class="o">=</span> <span class="s2">&quot;testing_case_nyc&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Use-tour()-to-set-the-configuration">Use tour() to set the configuration<a class="anchor-link" href="#Use-tour()-to-set-the-configuration">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rdf</span><span class="o">.</span><span class="n">tour</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's how I set the columns</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rdf</span><span class="o">.</span><span class="n">set_y</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is how I set the configuration:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">rdf</span><span class="o">.</span><span class="n">df</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span><span class="n">col</span><span class="p">,</span><span class="s2">&quot;&lt;&quot;</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">rdf</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">md5hash</span><span class="p">(</span><span class="n">col</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt;&gt;&gt;&gt;&gt; id &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;id&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: True, &#39;is_y&#39;: False, &#39;is_emb&#39;: True, &#39;use&#39;: False}
&gt;&gt;&gt;&gt;&gt; name &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;name&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: False, &#39;is_y&#39;: False, &#39;is_emb&#39;: True, &#39;use&#39;: True}
&gt;&gt;&gt;&gt;&gt; host_id &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;host_id&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: False, &#39;is_y&#39;: False, &#39;is_emb&#39;: True, &#39;use&#39;: True}
&gt;&gt;&gt;&gt;&gt; host_name &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;host_name&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: True, &#39;is_y&#39;: False, &#39;is_emb&#39;: True, &#39;use&#39;: False}
&gt;&gt;&gt;&gt;&gt; neighbourhood_group &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;neighbourhood_group&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: False, &#39;is_y&#39;: False, &#39;is_emb&#39;: True, &#39;use&#39;: True}
&gt;&gt;&gt;&gt;&gt; neighbourhood &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;neighbourhood&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: False, &#39;is_y&#39;: False, &#39;is_emb&#39;: True, &#39;use&#39;: True}
&gt;&gt;&gt;&gt;&gt; latitude &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;latitude&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: True, &#39;is_y&#39;: False, &#39;is_emb&#39;: True, &#39;use&#39;: True}
&gt;&gt;&gt;&gt;&gt; longitude &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;longitude&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: True, &#39;is_y&#39;: False, &#39;is_emb&#39;: True, &#39;use&#39;: True}
&gt;&gt;&gt;&gt;&gt; room_type &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;room_type&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: False, &#39;is_y&#39;: False, &#39;is_emb&#39;: True, &#39;use&#39;: True}
&gt;&gt;&gt;&gt;&gt; price &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;price&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: True, &#39;is_y&#39;: True, &#39;is_emb&#39;: False, &#39;use&#39;: True}
&gt;&gt;&gt;&gt;&gt; minimum_nights &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;minimum_nights&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: True, &#39;is_y&#39;: False, &#39;is_emb&#39;: True, &#39;use&#39;: True}
&gt;&gt;&gt;&gt;&gt; number_of_reviews &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;number_of_reviews&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: True, &#39;is_y&#39;: False, &#39;is_emb&#39;: True, &#39;use&#39;: True}
&gt;&gt;&gt;&gt;&gt; last_review &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;last_review&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: True, &#39;is_y&#39;: False, &#39;is_emb&#39;: True, &#39;use&#39;: False}
&gt;&gt;&gt;&gt;&gt; reviews_per_month &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;reviews_per_month&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: True, &#39;is_y&#39;: False, &#39;is_emb&#39;: True, &#39;use&#39;: True}
&gt;&gt;&gt;&gt;&gt; calculated_host_listings_count &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;calculated_host_listings_count&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: True, &#39;is_y&#39;: False, &#39;is_emb&#39;: True, &#39;use&#39;: True}
&gt;&gt;&gt;&gt;&gt; availability_365 &lt;&lt;&lt;&lt;&lt;
{&#39;name&#39;: &#39;availability_365&#39;, &#39;defined&#39;: True, &#39;is_conti&#39;: True, &#39;is_y&#39;: False, &#39;is_emb&#39;: True, &#39;use&#39;: True}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">rdf</span><span class="o">.</span><span class="n">Xs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;Rich Column:name&gt;,
 &lt;Rich Column:host_id&gt;,
 &lt;Rich Column:neighbourhood_group&gt;,
 &lt;Rich Column:neighbourhood&gt;,
 &lt;Rich Column:latitude&gt;,
 &lt;Rich Column:longitude&gt;,
 &lt;Rich Column:room_type&gt;,
 &lt;Rich Column:minimum_nights&gt;,
 &lt;Rich Column:number_of_reviews&gt;,
 &lt;Rich Column:reviews_per_month&gt;,
 &lt;Rich Column:calculated_host_listings_count&gt;,
 &lt;Rich Column:availability_365&gt;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rdf</span><span class="p">[</span><span class="s2">&quot;room_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;Entire home/apt&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TabularModel" class="doc_header"><code>class</code> <code>TabularModel</code><a href="https://github.com/raynardj/torchember/tree/master/torchember/whyhat.py#L351" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TabularModel</code>(<strong><code>rdf</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super(Model, self).__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TabularNN" class="doc_header"><code>class</code> <code>TabularNN</code><a href="https://github.com/raynardj/torchember/tree/master/torchember/whyhat.py#L404" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TabularNN</code>(<strong><code>rich_df</code></strong>, <strong><code>batch_size</code></strong>=<em><code>128</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rdf</span><span class="p">[</span><span class="s2">&quot;room_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">col</span><span class="o">.</span><span class="n">rc</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;Rich Column:room_type&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnn</span> <span class="o">=</span> <span class="n">TabularNN</span><span class="p">(</span><span class="n">rdf</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">coldf</span> <span class="o">=</span> <span class="n">tnn</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">top_freq</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">tnn</span><span class="o">.</span><span class="n">batch_df</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>host_id</th>
      <th>host_name</th>
      <th>neighbourhood_group</th>
      <th>neighbourhood</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>room_type</th>
      <th>price</th>
      <th>minimum_nights</th>
      <th>number_of_reviews</th>
      <th>last_review</th>
      <th>reviews_per_month</th>
      <th>calculated_host_listings_count</th>
      <th>availability_365</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>36444734</td>
      <td>Sunny Upper West Side Apt. 3mins from Central ...</td>
      <td>32987938</td>
      <td>Alex</td>
      <td>Manhattan</td>
      <td>Upper West Side</td>
      <td>40.77889</td>
      <td>-73.97668</td>
      <td>Entire home/apt</td>
      <td>143</td>
      <td>3</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>16987293</td>
      <td>New, Luxury and Sunny Apartment</td>
      <td>57455831</td>
      <td>Maggie</td>
      <td>Brooklyn</td>
      <td>Clinton Hill</td>
      <td>40.69440</td>
      <td>-73.96606</td>
      <td>Entire home/apt</td>
      <td>150</td>
      <td>1</td>
      <td>1</td>
      <td>2017-05-06</td>
      <td>0.04</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21154544</td>
      <td>Huge beautiful bedroom with double exposure</td>
      <td>66260832</td>
      <td>Dragana</td>
      <td>Manhattan</td>
      <td>Harlem</td>
      <td>40.81520</td>
      <td>-73.95175</td>
      <td>Private room</td>
      <td>50</td>
      <td>15</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2135489</td>
      <td>Charming Studio in Brooklyn</td>
      <td>8624212</td>
      <td>Leon</td>
      <td>Brooklyn</td>
      <td>Carroll Gardens</td>
      <td>40.68362</td>
      <td>-73.99714</td>
      <td>Entire home/apt</td>
      <td>170</td>
      <td>2</td>
      <td>131</td>
      <td>2019-06-16</td>
      <td>2.02</td>
      <td>1</td>
      <td>26</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11321187</td>
      <td>Entire 1Br Apt on UES</td>
      <td>59215698</td>
      <td>Daniela</td>
      <td>Manhattan</td>
      <td>Upper East Side</td>
      <td>40.76796</td>
      <td>-73.95205</td>
      <td>Entire home/apt</td>
      <td>130</td>
      <td>1</td>
      <td>21</td>
      <td>2019-07-07</td>
      <td>0.56</td>
      <td>2</td>
      <td>53</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>123</th>
      <td>15765350</td>
      <td>Doorman 2 Bed GYM DECK 5212</td>
      <td>16098958</td>
      <td>Jeremy &amp; Laura</td>
      <td>Manhattan</td>
      <td>Murray Hill</td>
      <td>40.74437</td>
      <td>-73.97295</td>
      <td>Entire home/apt</td>
      <td>190</td>
      <td>30</td>
      <td>4</td>
      <td>2019-01-14</td>
      <td>0.13</td>
      <td>96</td>
      <td>331</td>
    </tr>
    <tr>
      <th>124</th>
      <td>23307047</td>
      <td>2 Story PRIVATE Duplex/Elevator Building in NoMad</td>
      <td>172756149</td>
      <td>C</td>
      <td>Manhattan</td>
      <td>Kips Bay</td>
      <td>40.74121</td>
      <td>-73.98139</td>
      <td>Entire home/apt</td>
      <td>240</td>
      <td>1</td>
      <td>66</td>
      <td>2019-07-02</td>
      <td>4.09</td>
      <td>1</td>
      <td>83</td>
    </tr>
    <tr>
      <th>125</th>
      <td>6169068</td>
      <td>Prime Park Slope Townhouse, 4 BR and Garden</td>
      <td>9773128</td>
      <td>Deborah</td>
      <td>Brooklyn</td>
      <td>Park Slope</td>
      <td>40.66798</td>
      <td>-73.97610</td>
      <td>Entire home/apt</td>
      <td>345</td>
      <td>30</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>156</td>
    </tr>
    <tr>
      <th>126</th>
      <td>24122599</td>
      <td>Cozy room in a Victorian house in Central Broo...</td>
      <td>14905006</td>
      <td>Myriam</td>
      <td>Brooklyn</td>
      <td>Kensington</td>
      <td>40.63966</td>
      <td>-73.97160</td>
      <td>Private room</td>
      <td>52</td>
      <td>1</td>
      <td>11</td>
      <td>2019-05-27</td>
      <td>0.81</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>127</th>
      <td>18616234</td>
      <td>UPPER EAST SIDE PRIVATE ROOM!</td>
      <td>129317761</td>
      <td>Lauren</td>
      <td>Manhattan</td>
      <td>East Harlem</td>
      <td>40.78886</td>
      <td>-73.94324</td>
      <td>Private room</td>
      <td>70</td>
      <td>1</td>
      <td>11</td>
      <td>2017-07-15</td>
      <td>0.42</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>128 rows Ã— 16 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_data</span><span class="p">,</span><span class="n">y_data</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">tnn</span><span class="o">.</span><span class="n">batch_array</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/salvor/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:110: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;name&#39;: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0]),
 &#39;host_id&#39;: tensor([  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  24,
           0,   0,   0,   0,   0, 153,   0,   0,   0,   0,   0,   0,   0,   0,
           0,   0,   0,   1,   0,   0, 185,   0,   0, 133,   0,   0,   0,   0,
           0,   0,   0,   0,   0,   0,   0,   0,   0,   7,  92,   0,   0,  20,
           0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 106,   0,   0,
           0,   0,   0,   0,   0,   0,   2,   0,   0,   0,   0,   0,   0,   0,
           0,   0,   0,   0,   0,   0,   0,  75,   0,   0,   0, 237,   8,   0,
         224,   0, 345,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
           0,   0,   6,   0,   0,   0,   0,  47, 464,   0,   0,   6,   0,   0,
           0,   0]),
 &#39;neighbourhood_group&#39;: tensor([1, 2, 1, 2, 1, 1, 1, 2, 2, 2, 2, 1, 3, 1, 2, 1, 3, 2, 3, 5, 1, 2, 2, 1,
         2, 2, 2, 1, 3, 1, 3, 1, 1, 2, 2, 3, 2, 3, 2, 1, 1, 2, 2, 2, 3, 1, 1, 1,
         1, 3, 1, 1, 2, 1, 2, 2, 2, 2, 1, 2, 2, 3, 1, 1, 1, 1, 2, 2, 1, 3, 2, 1,
         2, 2, 1, 3, 1, 1, 2, 1, 1, 2, 1, 1, 1, 3, 1, 1, 2, 1, 2, 1, 1, 2, 3, 3,
         1, 1, 1, 2, 1, 2, 1, 1, 2, 1, 3, 3, 3, 4, 1, 1, 2, 2, 1, 2, 2, 1, 1, 2,
         1, 2, 2, 1, 1, 2, 2, 1]),
 &#39;neighbourhood&#39;: tensor([  5,  20,   3,  46,   8,   8,  11,  54,   4,   2,   4,  17,  65,   5,
          40,   8, 121,   2,  21, 126,  13,  73,   4,   3,   1,   4,   2,   8,
          15,  11,  15,  18,  62,   4,   2,  49,  61,  28,   1,   7,  10,   9,
           4,   4,  76,  11,  17,  34,   5,  93,  42,  26,  53,  16,   1,   2,
           4,   1,   7,   9,   9, 105,  27,  42,   5,  32,   1,   2,  17,  28,
           4,  26,  64,  25,  13,  15,  13,  14,   1,   7,  10,   9,   5,  14,
          14, 188,   3,   6,   2,   6,   4,  10,   7,  61,  50, 105,  26,   6,
          34,  55,  11, 109,  18,   8,   1,   5,  33,  50,  33,  85,   3,  81,
         182,   2,   5,  40,  12,   3,   8,  43,   3,   1,   2,  26,  27,  23,
          53,  11]),
 &#39;latitude&#39;: tensor([[40.7789],
         [40.6944],
         [40.8152],
         [40.6836],
         [40.7680],
         [40.7812],
         [40.7971],
         [40.6017],
         [40.6894],
         [40.6890],
         [40.7038],
         [40.7342],
         [40.7312],
         [40.7983],
         [40.6618],
         [40.7770],
         [40.7171],
         [40.6832],
         [40.7623],
         [40.5976],
         [40.7401],
         [40.6804],
         [40.7025],
         [40.8062],
         [40.7152],
         [40.7018],
         [40.6958],
         [40.7754],
         [40.7735],
         [40.8021],
         [40.7659],
         [40.7083],
         [40.7189],
         [40.6975],
         [40.6918],
         [40.7520],
         [40.6809],
         [40.7589],
         [40.7197],
         [40.7258],
         [40.7642],
         [40.6773],
         [40.7077],
         [40.7032],
         [40.5942],
         [40.7860],
         [40.7368],
         [40.7206],
         [40.7892],
         [40.5841],
         [40.8611],
         [40.7512],
         [40.6439],
         [40.8567],
         [40.7074],
         [40.6923],
         [40.7038],
         [40.7179],
         [40.7335],
         [40.6754],
         [40.6703],
         [40.6708],
         [40.7393],
         [40.8671],
         [40.7710],
         [40.7140],
         [40.7210],
         [40.6811],
         [40.7356],
         [40.7447],
         [40.6882],
         [40.7474],
         [40.6200],
         [40.6911],
         [40.7463],
         [40.7587],
         [40.7390],
         [40.7175],
         [40.7121],
         [40.7335],
         [40.7520],
         [40.6736],
         [40.8011],
         [40.7224],
         [40.7230],
         [40.7797],
         [40.8243],
         [40.7612],
         [40.6819],
         [40.7643],
         [40.7026],
         [40.7524],
         [40.7310],
         [40.6814],
         [40.7583],
         [40.6717],
         [40.7474],
         [40.7567],
         [40.7235],
         [40.6596],
         [40.7907],
         [40.7045],
         [40.7072],
         [40.7640],
         [40.7151],
         [40.7922],
         [40.7368],
         [40.7607],
         [40.7476],
         [40.8537],
         [40.8273],
         [40.7136],
         [40.5753],
         [40.6928],
         [40.7938],
         [40.6635],
         [40.7261],
         [40.8128],
         [40.7804],
         [40.6773],
         [40.8077],
         [40.7168],
         [40.6838],
         [40.7444],
         [40.7412],
         [40.6680],
         [40.6397],
         [40.7889]]),
 &#39;longitude&#39;: tensor([[-73.9767],
         [-73.9661],
         [-73.9518],
         [-73.9971],
         [-73.9520],
         [-73.9499],
         [-73.9347],
         [-73.9630],
         [-73.9088],
         [-73.9364],
         [-73.9192],
         [-74.0062],
         [-73.8666],
         [-73.9612],
         [-73.9822],
         [-73.9444],
         [-73.8241],
         [-73.9170],
         [-73.9297],
         [-74.0835],
         [-74.0007],
         [-74.0173],
         [-73.9206],
         [-73.9553],
         [-73.9430],
         [-73.9283],
         [-73.9408],
         [-73.9503],
         [-73.9265],
         [-73.9436],
         [-73.9083],
         [-74.0064],
         [-73.9976],
         [-73.9350],
         [-73.9286],
         [-73.8689],
         [-73.8889],
         [-73.8210],
         [-73.9602],
         [-73.9874],
         [-73.9770],
         [-73.9454],
         [-73.9231],
         [-73.9146],
         [-73.8004],
         [-73.9509],
         [-74.0024],
         [-73.9981],
         [-73.9676],
         [-73.8167],
         [-73.9296],
         [-73.9774],
         [-73.9813],
         [-73.9302],
         [-73.9501],
         [-73.9568],
         [-73.9271],
         [-73.9577],
         [-73.9890],
         [-73.9566],
         [-73.9526],
         [-73.7916],
         [-73.9776],
         [-73.9281],
         [-73.9894],
         [-73.9977],
         [-73.9601],
         [-73.9129],
         [-74.0060],
         [-73.8250],
         [-73.9163],
         [-73.9784],
         [-73.9549],
         [-73.9736],
         [-73.9914],
         [-73.9174],
         [-73.9975],
         [-73.9915],
         [-73.9584],
         [-73.9878],
         [-73.9725],
         [-73.9138],
         [-73.9652],
         [-73.9877],
         [-73.9925],
         [-73.7786],
         [-73.9451],
         [-73.9917],
         [-73.9581],
         [-73.9891],
         [-73.9170],
         [-73.9715],
         [-73.9848],
         [-73.8942],
         [-73.8801],
         [-73.7967],
         [-73.9794],
         [-73.9977],
         [-74.0041],
         [-73.9838],
         [-73.9397],
         [-73.9858],
         [-74.0104],
         [-73.9637],
         [-73.9523],
         [-73.9741],
         [-73.9244],
         [-73.8794],
         [-73.9122],
         [-73.9017],
         [-73.9453],
         [-74.0176],
         [-74.0052],
         [-73.9442],
         [-73.9659],
         [-73.9844],
         [-73.9481],
         [-73.9516],
         [-73.9466],
         [-73.9837],
         [-73.9550],
         [-73.9562],
         [-73.9215],
         [-73.9730],
         [-73.9814],
         [-73.9761],
         [-73.9716],
         [-73.9432]]),
 &#39;room_type&#39;: tensor([1, 1, 2, 1, 1, 1, 2, 2, 2, 1, 2, 1, 2, 2, 1, 1, 2, 3, 1, 2, 1, 1, 2, 1,
         2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2,
         1, 1, 1, 1, 2, 3, 2, 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 2,
         1, 1, 2, 2, 1, 2, 2, 2, 1, 1, 2, 2, 1, 3, 2, 2, 1, 2, 1, 2, 2, 1, 2, 3,
         1, 2, 2, 1, 2, 1, 1, 1, 1, 1, 2, 2, 1, 2, 1, 1, 1, 2, 1, 1, 1, 2, 1, 2,
         2, 2, 1, 1, 1, 1, 2, 2]),
 &#39;minimum_nights&#39;: tensor([[ 3.],
         [ 1.],
         [15.],
         [ 2.],
         [ 1.],
         [50.],
         [ 6.],
         [ 1.],
         [ 1.],
         [ 4.],
         [ 2.],
         [ 9.],
         [ 2.],
         [30.],
         [ 4.],
         [ 2.],
         [ 1.],
         [ 1.],
         [ 2.],
         [ 4.],
         [ 3.],
         [ 1.],
         [ 1.],
         [ 2.],
         [ 1.],
         [ 4.],
         [ 2.],
         [ 4.],
         [ 1.],
         [ 1.],
         [ 1.],
         [29.],
         [ 2.],
         [ 2.],
         [ 2.],
         [ 2.],
         [ 1.],
         [ 1.],
         [ 2.],
         [ 5.],
         [ 6.],
         [ 3.],
         [ 7.],
         [14.],
         [ 2.],
         [ 6.],
         [ 2.],
         [ 3.],
         [ 6.],
         [ 2.],
         [26.],
         [30.],
         [ 1.],
         [ 2.],
         [ 3.],
         [ 2.],
         [14.],
         [ 7.],
         [ 2.],
         [ 5.],
         [ 1.],
         [ 1.],
         [ 5.],
         [ 2.],
         [ 2.],
         [ 2.],
         [ 1.],
         [ 5.],
         [ 1.],
         [ 3.],
         [ 2.],
         [10.],
         [ 5.],
         [ 2.],
         [ 1.],
         [ 2.],
         [30.],
         [ 2.],
         [ 3.],
         [ 1.],
         [ 3.],
         [ 2.],
         [ 2.],
         [ 1.],
         [ 2.],
         [ 2.],
         [ 2.],
         [22.],
         [ 3.],
         [ 1.],
         [ 2.],
         [ 3.],
         [ 1.],
         [ 5.],
         [ 1.],
         [ 4.],
         [30.],
         [ 2.],
         [ 1.],
         [ 3.],
         [ 3.],
         [ 2.],
         [ 1.],
         [ 3.],
         [ 2.],
         [30.],
         [ 7.],
         [ 1.],
         [ 2.],
         [ 1.],
         [ 2.],
         [ 1.],
         [ 4.],
         [ 3.],
         [30.],
         [ 1.],
         [ 3.],
         [ 3.],
         [ 5.],
         [ 1.],
         [ 1.],
         [ 1.],
         [ 2.],
         [30.],
         [ 1.],
         [30.],
         [ 1.],
         [ 1.]]),
 &#39;number_of_reviews&#39;: tensor([[ 23.2745],
         [  1.0000],
         [ 23.2745],
         [131.0000],
         [ 21.0000],
         [ 23.2745],
         [ 14.0000],
         [  3.0000],
         [ 23.2745],
         [ 23.2745],
         [ 23.2745],
         [ 23.2745],
         [ 26.0000],
         [  1.0000],
         [  2.0000],
         [  4.0000],
         [ 10.0000],
         [  1.0000],
         [ 16.0000],
         [  6.0000],
         [ 23.2745],
         [ 50.0000],
         [ 23.2745],
         [ 11.0000],
         [ 17.0000],
         [  1.0000],
         [ 51.0000],
         [147.0000],
         [  2.0000],
         [  1.0000],
         [ 30.0000],
         [ 23.2745],
         [ 44.0000],
         [  5.0000],
         [  9.0000],
         [ 14.0000],
         [ 91.0000],
         [ 39.0000],
         [ 24.0000],
         [166.0000],
         [  3.0000],
         [ 23.2745],
         [ 28.0000],
         [ 23.2745],
         [ 35.0000],
         [  4.0000],
         [ 47.0000],
         [ 21.0000],
         [ 21.0000],
         [ 13.0000],
         [  4.0000],
         [  2.0000],
         [ 52.0000],
         [ 23.2745],
         [  2.0000],
         [ 12.0000],
         [ 23.2745],
         [ 23.2745],
         [  3.0000],
         [  1.0000],
         [ 23.2745],
         [154.0000],
         [ 13.0000],
         [120.0000],
         [  5.0000],
         [  3.0000],
         [ 12.0000],
         [ 23.2745],
         [ 23.2745],
         [ 95.0000],
         [ 92.0000],
         [ 23.2745],
         [ 15.0000],
         [ 73.0000],
         [ 23.2745],
         [  2.0000],
         [ 23.2745],
         [ 23.2745],
         [  4.0000],
         [ 39.0000],
         [ 17.0000],
         [ 49.0000],
         [ 14.0000],
         [  1.0000],
         [168.0000],
         [  6.0000],
         [ 28.0000],
         [  1.0000],
         [  1.0000],
         [147.0000],
         [  3.0000],
         [  1.0000],
         [114.0000],
         [  2.0000],
         [ 12.0000],
         [  4.0000],
         [ 23.2745],
         [290.0000],
         [ 23.2745],
         [  3.0000],
         [  4.0000],
         [150.0000],
         [  8.0000],
         [  1.0000],
         [ 59.0000],
         [ 23.2745],
         [ 23.2745],
         [296.0000],
         [ 15.0000],
         [  1.0000],
         [  9.0000],
         [ 23.2745],
         [ 23.2745],
         [ 40.0000],
         [  1.0000],
         [  7.0000],
         [  3.0000],
         [  3.0000],
         [  1.0000],
         [ 28.0000],
         [ 95.0000],
         [ 38.0000],
         [ 23.2745],
         [  4.0000],
         [ 66.0000],
         [ 23.2745],
         [ 11.0000],
         [ 11.0000]]),
 &#39;reviews_per_month&#39;: tensor([[ 1.3732],
         [ 0.0400],
         [ 1.3732],
         [ 2.0200],
         [ 0.5600],
         [ 1.3732],
         [ 0.3500],
         [ 1.1500],
         [ 1.3732],
         [ 1.3732],
         [ 1.3732],
         [ 1.3732],
         [ 1.9600],
         [ 0.7900],
         [ 0.2800],
         [ 0.4900],
         [10.0000],
         [ 0.0400],
         [ 0.4400],
         [ 0.4100],
         [ 1.3732],
         [ 0.9200],
         [ 1.3732],
         [ 0.5100],
         [ 0.5500],
         [ 0.0200],
         [ 0.8600],
         [ 2.7600],
         [ 0.0700],
         [ 1.0000],
         [ 5.8100],
         [ 1.3732],
         [ 5.6400],
         [ 0.7900],
         [ 3.4200],
         [ 5.0000],
         [ 1.8100],
         [ 3.4900],
         [ 0.5600],
         [ 1.6800],
         [ 0.2200],
         [ 1.3732],
         [ 2.7800],
         [ 1.3732],
         [ 0.9500],
         [ 0.0600],
         [ 1.1600],
         [ 0.6300],
         [ 1.8300],
         [ 1.5400],
         [ 0.3500],
         [ 0.3800],
         [ 2.4700],
         [ 1.3732],
         [ 0.0600],
         [ 1.3500],
         [ 1.3732],
         [ 1.3732],
         [ 0.0800],
         [ 0.0400],
         [ 1.3732],
         [ 8.2400],
         [ 1.2300],
         [ 1.2700],
         [ 4.2900],
         [ 0.2100],
         [ 0.5300],
         [ 1.3732],
         [ 1.3732],
         [ 3.5200],
         [ 4.3300],
         [ 1.3732],
         [ 1.0100],
         [ 1.3900],
         [ 1.3732],
         [ 0.0800],
         [ 1.3732],
         [ 1.3732],
         [ 0.4800],
         [ 2.0000],
         [ 2.4900],
         [ 3.3100],
         [ 1.0600],
         [ 0.0200],
         [ 3.9300],
         [ 0.9500],
         [ 0.8200],
         [ 0.0900],
         [ 0.1600],
         [ 5.4500],
         [ 0.0600],
         [ 0.0300],
         [ 7.9700],
         [ 0.0600],
         [ 9.7300],
         [ 0.4100],
         [ 1.3732],
         [ 5.9200],
         [ 1.3732],
         [ 3.0000],
         [ 3.0000],
         [ 2.5700],
         [ 0.3400],
         [ 0.0500],
         [ 3.2800],
         [ 1.3732],
         [ 1.3732],
         [10.6000],
         [ 1.0200],
         [ 1.0000],
         [ 0.2900],
         [ 1.3732],
         [ 1.3732],
         [ 1.9900],
         [ 0.0500],
         [ 0.1200],
         [ 0.0600],
         [ 0.3900],
         [ 1.0000],
         [ 1.4400],
         [ 3.9300],
         [ 0.6300],
         [ 1.3732],
         [ 0.1300],
         [ 4.0900],
         [ 1.3732],
         [ 0.8100],
         [ 0.4200]]),
 &#39;calculated_host_listings_count&#39;: tensor([[  1.],
         [  2.],
         [  1.],
         [  1.],
         [  2.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [ 32.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  8.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [327.],
         [  2.],
         [  1.],
         [  8.],
         [  1.],
         [  2.],
         [  9.],
         [  1.],
         [  2.],
         [  1.],
         [  2.],
         [  3.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  2.],
         [  1.],
         [  1.],
         [  1.],
         [ 91.],
         [ 11.],
         [  1.],
         [  1.],
         [ 34.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  2.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  3.],
         [ 10.],
         [  1.],
         [  1.],
         [  2.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [232.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  3.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  2.],
         [  1.],
         [  1.],
         [  3.],
         [  2.],
         [ 12.],
         [  1.],
         [  1.],
         [  1.],
         [  7.],
         [ 87.],
         [  1.],
         [  7.],
         [  2.],
         [  6.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  2.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  1.],
         [  3.],
         [ 96.],
         [  1.],
         [  1.],
         [  2.],
         [  1.],
         [ 17.],
         [  5.],
         [  1.],
         [  1.],
         [ 96.],
         [  1.],
         [  1.],
         [  1.],
         [  1.]]),
 &#39;availability_365&#39;: tensor([[ 10.0000],
         [112.7813],
         [112.7813],
         [ 26.0000],
         [ 53.0000],
         [112.7813],
         [335.0000],
         [112.7813],
         [175.0000],
         [112.7813],
         [112.7813],
         [112.7813],
         [180.0000],
         [335.0000],
         [179.0000],
         [112.7813],
         [160.0000],
         [179.0000],
         [112.7813],
         [285.0000],
         [252.0000],
         [ 19.0000],
         [  5.0000],
         [ 18.0000],
         [354.0000],
         [112.7813],
         [179.0000],
         [310.0000],
         [112.7813],
         [ 17.0000],
         [ 85.0000],
         [342.0000],
         [275.0000],
         [128.0000],
         [268.0000],
         [ 32.0000],
         [255.0000],
         [342.0000],
         [112.7813],
         [365.0000],
         [351.0000],
         [112.7813],
         [ 28.0000],
         [112.7813],
         [  4.0000],
         [112.7813],
         [361.0000],
         [ 82.0000],
         [116.0000],
         [ 73.0000],
         [ 58.0000],
         [241.0000],
         [ 42.0000],
         [363.0000],
         [112.7813],
         [305.0000],
         [112.7813],
         [112.7813],
         [112.7813],
         [112.7813],
         [112.7813],
         [112.7813],
         [ 24.0000],
         [132.0000],
         [ 94.0000],
         [  5.0000],
         [112.7813],
         [356.0000],
         [112.7813],
         [ 63.0000],
         [  4.0000],
         [ 19.0000],
         [105.0000],
         [ 20.0000],
         [112.7813],
         [ 87.0000],
         [320.0000],
         [ 23.0000],
         [112.7813],
         [112.7813],
         [ 33.0000],
         [210.0000],
         [  8.0000],
         [112.7813],
         [ 65.0000],
         [169.0000],
         [ 80.0000],
         [187.0000],
         [112.7813],
         [174.0000],
         [359.0000],
         [365.0000],
         [ 38.0000],
         [112.7813],
         [112.7813],
         [365.0000],
         [365.0000],
         [ 26.0000],
         [331.0000],
         [302.0000],
         [ 90.0000],
         [309.0000],
         [ 54.0000],
         [  5.0000],
         [ 81.0000],
         [358.0000],
         [112.7813],
         [322.0000],
         [ 27.0000],
         [363.0000],
         [112.7813],
         [365.0000],
         [ 19.0000],
         [ 70.0000],
         [250.0000],
         [112.7813],
         [110.0000],
         [112.7813],
         [ 23.0000],
         [362.0000],
         [224.0000],
         [157.0000],
         [112.7813],
         [331.0000],
         [ 83.0000],
         [156.0000],
         [112.7813],
         [112.7813]])}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">dnn</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Sequential(
  (0): Linear(in_features=107, out_features=107, bias=True)
  (1): BatchNorm1d(107, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (2): ReLU()
  (3): Linear(in_features=107, out_features=1, bias=True)
  (4): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ipts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tnn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">xcol</span><span class="o">.</span><span class="n">name</span><span class="p">](</span><span class="n">x_data</span><span class="p">[</span><span class="n">xcol</span><span class="o">.</span><span class="n">name</span><span class="p">])</span> <span class="k">for</span> <span class="n">xcol</span> <span class="ow">in</span> <span class="n">tnn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rdf</span><span class="o">.</span><span class="n">Xs</span><span class="p">)</span>
<span class="n">concat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">ipts</span><span class="p">,</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">concat</span><span class="p">,</span><span class="n">concat</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor([[-0.3061,  0.5583, -1.7048,  ..., -0.1683, -0.2213, -0.8510],
         [-0.3061,  0.5583, -1.7048,  ..., -0.6799, -0.1963, -0.3392],
         [-0.3061,  0.5583, -1.7048,  ..., -0.1683, -0.2213, -0.3392],
         ...,
         [-0.3061,  0.5583, -1.7048,  ..., -0.1683, -0.2213,  0.0281],
         [-0.3061,  0.5583, -1.7048,  ..., -0.4205, -0.2213, -0.3392],
         [-0.3061,  0.5583, -1.7048,  ..., -0.5656, -0.2213, -0.3392]],
        grad_fn=&lt;CatBackward&gt;), torch.Size([128, 107]))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">tnn</span><span class="o">.</span><span class="n">batch_y_pred</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/salvor/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:110: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 0.1854],
        [ 0.4965],
        [ 0.0657],
        [ 0.5390],
        [ 0.0346],
        [ 0.1109],
        [ 1.0257],
        [ 0.9426],
        [-1.4236],
        [-0.4027],
        [-1.3949],
        [ 1.0144],
        [ 1.6111],
        [ 0.4727],
        [-0.3963],
        [ 0.0993],
        [ 1.8734],
        [-0.5209],
        [ 1.1702],
        [-0.6602],
        [ 0.9155],
        [-0.1697],
        [-1.4661],
        [ 0.3416],
        [ 0.0491],
        [-1.4276],
        [-0.3420],
        [ 0.0853],
        [ 0.3223],
        [ 1.3579],
        [ 0.5943],
        [ 0.3173],
        [-0.9157],
        [-1.4335],
        [-1.6335],
        [-0.1290],
        [-0.4366],
        [ 2.6865],
        [-0.5450],
        [-0.8102],
        [ 0.2763],
        [-1.5096],
        [-1.4165],
        [-1.3428],
        [-0.5520],
        [ 1.3585],
        [ 0.8928],
        [ 0.5567],
        [ 0.2359],
        [-0.9065],
        [ 0.3392],
        [-0.8105],
        [-1.2481],
        [ 0.7013],
        [ 0.2318],
        [-0.7692],
        [-1.3154],
        [-0.5138],
        [-1.1481],
        [-1.4941],
        [-1.3265],
        [ 2.1126],
        [ 0.6395],
        [ 0.6270],
        [ 0.3102],
        [ 0.2761],
        [-0.5575],
        [-2.1002],
        [ 1.0423],
        [ 2.4838],
        [-1.5184],
        [ 0.7619],
        [-0.4804],
        [-1.2091],
        [ 0.2233],
        [ 0.7135],
        [ 0.5420],
        [-0.5502],
        [ 0.2483],
        [-1.1345],
        [ 0.4551],
        [-1.6280],
        [ 0.8449],
        [-0.4392],
        [-0.2708],
        [ 0.9606],
        [ 0.2369],
        [ 0.8148],
        [-0.3557],
        [ 0.7816],
        [-1.4975],
        [ 1.1632],
        [-1.2288],
        [-0.2945],
        [ 1.4050],
        [ 2.5949],
        [ 0.6319],
        [ 0.7928],
        [-1.1700],
        [-0.2946],
        [ 2.8332],
        [-0.5895],
        [ 0.3957],
        [ 0.0810],
        [-0.5038],
        [ 0.0837],
        [ 0.9681],
        [ 1.1302],
        [-0.0971],
        [ 0.5286],
        [ 0.3181],
        [-0.8433],
        [-0.8857],
        [-1.8803],
        [ 0.2565],
        [-0.3163],
        [-1.0606],
        [ 0.2665],
        [ 0.0986],
        [-0.5930],
        [ 0.9827],
        [ 0.1503],
        [-0.4754],
        [ 0.1420],
        [ 0.5774],
        [ 0.1458],
        [-1.0844],
        [ 0.9949]], grad_fn=&lt;NativeBatchNormBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

